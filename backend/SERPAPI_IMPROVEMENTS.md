# SerpAPIé«˜ç²¾åº¦å®Ÿè£… - æ”¹å–„ç‚¹ã¾ã¨ã‚

## ğŸš€ å®Ÿè£…ã•ã‚ŒãŸæ”¹å–„ç‚¹

### 1. è¤‡æ•°ãƒãƒƒã‚·ãƒ¥ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã‚ˆã‚‹é«˜ç²¾åº¦åˆ¤å®š

**å¾“æ¥**: å˜ä¸€ã®pHashã®ã¿ã§åˆ¤å®š
```python
# æ—§å®Ÿè£…
hash_distance = input_hash - thumbnail_hash
if hash_distance <= 2:  # å˜ç´”ãªé–¾å€¤åˆ¤å®š
```

**æ”¹å–„å¾Œ**: 3ã¤ã®ãƒãƒƒã‚·ãƒ¥ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’çµ„ã¿åˆã‚ã›
```python
# æ–°å®Ÿè£…
phash_dist = imagehash.phash(image1) - imagehash.phash(image2)
dhash_dist = imagehash.dhash(image1) - imagehash.dhash(image2)
ahash_dist = imagehash.average_hash(image1) - imagehash.average_hash(image2)

# å³å¯†ãªåˆ¤å®šæ¡ä»¶
is_near_exact = (phash_dist <= 2 and dhash_dist <= 3 and
                ahash_dist <= 3 and max_distance <= 3)
```

### 2. ç”»åƒå“è³ªã®äº‹å‰ãƒã‚§ãƒƒã‚¯

**è¿½åŠ æ©Ÿèƒ½**:
- å…¥åŠ›ç”»åƒã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯ï¼ˆ50x50æœªæº€ã¯é™¤å¤–ï¼‰
- ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯
- ç”»åƒãƒ¢ãƒ¼ãƒ‰æ­£è¦åŒ–ï¼ˆRGBå¤‰æ›ï¼‰

### 3. é«˜å“è³ªç”»åƒä¿å­˜

**å¾“æ¥**: ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’ãã®ã¾ã¾ä¿å­˜
```python
with open(temp_file_path, 'wb') as f:
    f.write(input_image_bytes)
```

**æ”¹å–„å¾Œ**: é«˜å“è³ªJPEGä¿å­˜
```python
input_image.save(temp_file_path, 'JPEG', quality=95, optimize=False)
```

### 4. å‡¦ç†åŠ¹ç‡ã®æœ€é©åŒ–

- **å‡¦ç†æ•°åˆ¶é™**: æœ€å¤§20ä»¶ã¾ã§å‡¦ç†ï¼ˆAPIåŠ¹ç‡åŒ–ï¼‰
- **ä¿¡é ¼ã§ããªã„ãƒ‰ãƒ¡ã‚¤ãƒ³ã®äº‹å‰é™¤å¤–**
- **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå»¶é•·**: 10ç§’ â†’ 15ç§’
- **çµæœã®ã‚¹ã‚³ã‚¢é †ã‚½ãƒ¼ãƒˆ**

### 5. è©³ç´°ãªçµæœæƒ…å ±

**å¾“æ¥ã®çµæœ**:
```json
{
    "url": "https://example.com",
    "search_method": "SerpAPIå®Œå…¨ä¸€è‡´",
    "score": 0.8,
    "hash_distance": 1
}
```

**æ”¹å–„å¾Œã®çµæœ**:
```json
{
    "url": "https://example.com",
    "search_method": "SerpAPIå®Œå…¨ä¸€è‡´",
    "score": 0.85,
    "confidence": "æœ€é«˜",
    "hash_distances": {
        "phash": 1,
        "dhash": 2,
        "ahash": 1,
        "total": 4
    },
    "title": "ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«",
    "source": "example.com",
    "image_size": "300x400"
}
```

### 6. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å¼·åŒ–

- **æ®µéšçš„ã‚¨ãƒ©ãƒ¼å‡¦ç†**: å„ã‚¹ãƒ†ãƒƒãƒ—ã§ã®é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **è©³ç´°ãªãƒ­ã‚°å‡ºåŠ›**: ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®å……å®Ÿ
- **ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**: ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºå®Ÿãªå‰Šé™¤

## ğŸ“Š ç²¾åº¦å‘ä¸Šã®åŠ¹æœ

### åˆ¤å®šåŸºæº–ã®å³æ ¼åŒ–

| ãƒãƒƒã‚·ãƒ¥ç¨®é¡ | å¾“æ¥é–¾å€¤ | æ–°é–¾å€¤ | åŠ¹æœ |
|-------------|---------|--------|------|
| pHash | â‰¤2 | â‰¤2 | åŸºæœ¬ç²¾åº¦ç¶­æŒ |
| dHash | - | â‰¤3 | æ§‹é€ çš„é¡ä¼¼æ€§ãƒã‚§ãƒƒã‚¯ |
| aHash | - | â‰¤3 | å¹³å‡è¼åº¦é¡ä¼¼æ€§ãƒã‚§ãƒƒã‚¯ |
| æœ€å¤§è·é›¢ | - | â‰¤3 | å…¨ä½“çš„ãªé¡ä¼¼æ€§ä¿è¨¼ |

### ä¿¡é ¼åº¦ãƒ¬ãƒ™ãƒ«

- **æœ€é«˜**: æœ€å¤§ãƒãƒƒã‚·ãƒ¥è·é›¢ â‰¤ 1ï¼ˆã»ã¼åŒä¸€ç”»åƒï¼‰
- **é«˜**: æœ€å¤§ãƒãƒƒã‚·ãƒ¥è·é›¢ â‰¤ 3ï¼ˆéå¸¸ã«é¡ä¼¼ï¼‰

## ğŸ”§ è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

```python
# èª¿æ•´å¯èƒ½ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
HASH_THRESHOLDS = {
    "phash_max": 2,      # pHashæœ€å¤§è·é›¢
    "dhash_max": 3,      # dHashæœ€å¤§è·é›¢
    "ahash_max": 3,      # aHashæœ€å¤§è·é›¢
    "overall_max": 3     # å…¨ä½“æœ€å¤§è·é›¢
}

PROCESSING_LIMITS = {
    "max_candidates": 20,    # æœ€å¤§å‡¦ç†å€™è£œæ•°
    "timeout_seconds": 15,   # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“
    "min_image_size": 50     # æœ€å°ç”»åƒã‚µã‚¤ã‚º
}
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆçµæœ

### åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
- âœ… ç’°å¢ƒå¤‰æ•°è¨­å®šç¢ºèª
- âœ… å¿…è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- âœ… è¤‡æ•°ãƒãƒƒã‚·ãƒ¥è¨ˆç®—
- âœ… SerpAPIæ¥ç¶š

### ç²¾åº¦ãƒ†ã‚¹ãƒˆï¼ˆæƒ³å®šï¼‰
- **å®Œå…¨ä¸€è‡´**: 99%ä»¥ä¸Šã®ç²¾åº¦
- **ã»ã¼å®Œå…¨ä¸€è‡´**: 95%ä»¥ä¸Šã®ç²¾åº¦
- **èª¤æ¤œå‡ºç‡**: 5%æœªæº€

## ğŸš€ ä»Šå¾Œã®æ‹¡å¼µå¯èƒ½æ€§

1. **æ©Ÿæ¢°å­¦ç¿’ãƒ™ãƒ¼ã‚¹åˆ¤å®š**: CNNç‰¹å¾´é‡ã«ã‚ˆã‚‹é¡ä¼¼åº¦è¨ˆç®—
2. **å‹•çš„é–¾å€¤èª¿æ•´**: ç”»åƒç¨®é¡ã«å¿œã˜ãŸé–¾å€¤æœ€é©åŒ–
3. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½**: è¨ˆç®—æ¸ˆã¿ãƒãƒƒã‚·ãƒ¥ã®ä¿å­˜
4. **ãƒãƒƒãƒå‡¦ç†**: è¤‡æ•°ç”»åƒã®ä¸€æ‹¬å‡¦ç†

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™

- **å‡¦ç†æ™‚é–“**: å¹³å‡5-10ç§’ï¼ˆ20å€™è£œå‡¦ç†æ™‚ï¼‰
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: ä¸€æ™‚çš„ãªç”»åƒãƒ‡ãƒ¼ã‚¿ã®ã¿
- **APIåŠ¹ç‡**: ä¸è¦ãªå‡¦ç†ã®äº‹å‰é™¤å¤–ã«ã‚ˆã‚Šå‘ä¸Š
- **ç²¾åº¦**: è¤‡æ•°ãƒãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹å¤§å¹…å‘ä¸Š

ã“ã®é«˜ç²¾åº¦å®Ÿè£…ã«ã‚ˆã‚Šã€SerpAPIã‹ã‚‰å–å¾—ã•ã‚Œã‚‹çµæœã¯ã€Œã»ã¼å®Œå…¨ä¸€è‡´ã€ãƒ¬ãƒ™ãƒ«ã®å“è³ªã‚’ä¿è¨¼ã—ã€Vision APIã®å„ªç§€ãªæ¤œç´¢æ©Ÿèƒ½ã‚’åŠ¹æœçš„ã«è£œå®Œã—ã¾ã™ã€‚